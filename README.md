# 🔥利用歷史天氣與野火數據預測南加州火災風險🔥

## ❓ 問題陳述
2024年9月初，美國加州和內華達州因持續高溫和乾燥天氣爆發多起野火。最具代表性的是南加州的幾場野火，包括在洛杉磯東部和聖伯納地諾國家森林的火災，這些火災迅速蔓延，我們能否利用歷史天氣和野火數據來預測火災發生的可能性？

## 📦 樣品詳情

[California Weather and Fire Prediction Dataset (1984–2025) with Engineered Features](https://zenodo.org/records/14712845) <br>
- 1984 年至 2025 年期間
- 對同一月和同一年內不同地點發生共`14987`起火災實例進行多重索引
- 我們合併的資料集中發生了 `5096` 起火災
- `9891` 筆記錄無火災發生紀錄

## 📊 數據詳情 

### Data Dictionary:
| 欄位名稱               | 說明                                                                 |
|------------------------|----------------------------------------------------------------------|
| DATE                   | 當天的觀測日期                                                       |
| PRECIPITATION          | 每日降水量（英吋）                                                   |
| MAX_TEMP               | 每日最高氣溫（華氏）                                                 |
| MIN_TEMP               | 每日最低氣溫（華氏）                                                 |
| AVG_WIND_SPEED         | 每日平均風速（英里/小時）                                           |
| FIRE_START_DAY         | 是否於該日發生野火（布林值：True/False）                            |
| YEAR                   | 年份                                                                 |
| TEMP_RANGE             | 當日最高與最低溫差，反映氣溫變化程度                                |
| WIND_TEMP_RATIO        | 平均風速與最高溫度的比值，捕捉風與溫度間的動態關係                  |
| MONTH                  | 月份（1–12）                                                        |
| SEASON                 | 季節（Winter, Spring, Summer, Fall）                                |
| LAGGED_PRECIPITATION   | 前 7 天的累積降水量，反映近一週的濕潤條件                            |
| LAGGED_AVG_WIND_SPEED  | 前 7 天的平均風速，反映持續的風力狀況                                |
| DAY_OF_YEAR            | 當年度中的天數（1–365 或 366）                                     |

#### 根據[NOAA](https://www.noaa.gov/noaa-wildfire)和[Climate](https://www.climate.gov/news-features/event-tracker/weather-and-climate-influences-january-2025-fires-around-los-angeles)我額外加入下面五種指標

### 1. 氣溫變異指數（Temperature Variation Index）  
| **項目**      | **內容**                                                                                   |
|---------------|--------------------------------------------------------------------------------------------|
| **定義**      | 每日氣溫的變異程度，反映當天最高和最低氣溫之間的差異。較大的溫差可能與氣候極端性相關，進一步加劇火災風險。 |
| **公式**      | `TEMP_VARIATION = MAX_TEMP - MIN_TEMP`                                                     |

### 2. 降水與風速比率（Precipitation-Wind Ratio）  
| **項目**      | **內容**                                                                                   |
|---------------|--------------------------------------------------------------------------------------------|
| **定義**      | 衡量降水量與風速之間的關聯。當降水量低且風速高時，通常意味著乾燥條件與強風並存，火災風險上升。            |
| **公式**      | `PRECIPITATION_WIND_RATIO = PRECIPITATION / AVG_WIND_SPEED`                                |

### 3. 季節性降水與風速關聯指數（Seasonal Precipitation-Wind Index）  
| **項目**      | **內容**                                                                                   |
|---------------|--------------------------------------------------------------------------------------------|
| **定義**      | 綜合考量季節（SEASON）對降水與風速影響的指標。不同季節降水和風速的組合，會對火災風險產生不同作用。          |
| **公式**      | `SEASONAL_PRECIP_WIND = (PRECIPITATION * (SEASON == 'Winter')) + (AVG_WIND_SPEED * (SEASON == 'Summer'))` |

### 4. 季節性乾燥指數（Seasonal Dryness Index）  
| **項目**      | **內容**                                                                                   |
|---------------|--------------------------------------------------------------------------------------------|
| **定義**      | 根據當季（秋季或冬季）的降水量與日溫差來評估乾燥程度。乾燥季節中的高乾燥值與火災風險高度相關。             |
| **公式**      | `SEASONAL_DRYNESS = (PRECIPITATION * (SEASON == 'Fall' or SEASON == 'Winter')) / (MAX_TEMP - MIN_TEMP)` |

### 5. 日中溫差與風速結合指數（Diurnal Temperature and Wind Speed Index） 
| **項目**      | **內容**                                                                                   |
|---------------|--------------------------------------------------------------------------------------------|
| **定義**      | 此指標將每日的氣溫差（即日間溫度變化）與風速結合，評估乾燥和高風速的條件下，火災風險的潛在性。            |
| **公式**      | `DIURNAL_TEMP_WIND = (MAX_TEMP - MIN_TEMP) * AVG_WIND_SPEED` |



## 🧠 多種模型架構的比較與選擇策略

本專案整合了多種常見的分類模型，以達到更穩定、全面的預測能力。透過實作與比較不同演算法的行為與表現，有助於開發者根據資料特性與實際需求做出最佳選擇。

---

### 🔍 為什麼使用多模型？

- 不同模型對資料的假設與敏感度不同，有助於探索資料中的潛在模式。
- 可對齊真實業務需求進行調整（如解釋性 vs. 準確率）。
- 有助於後續進行集成學習（Ensemble Learning）或 AutoML 選模流程。

---

### 🎯 如何管理這些模型？

- 本專案採用 [MLflow](https://mlflow.org/) 作為機器學習與深度學習模型的實驗追蹤與管理工具。
- MLflow 是一個開源平台，支援完整的機器學習生命週期（ML lifecycle），涵蓋從實驗記錄、模型訓練、版本控管到部署的各個階段，能有效提升專案的可重現性與開發效率。
- **Tracking**：記錄每次實驗的參數（parameters）、評估指標（metrics）、模型產出（artifacts）與原始碼版本，便於實驗管理與結果比較。
- **Projects**：透過 `MLproject` 檔案標準化專案格式，支援使用 Conda 或 Docker 定義可重現的運行環境。
- **Models**：以統一格式（如 Python Function、ONNX、TorchScript）封裝模型，支援多種部署方式，例如本地部署、REST API 或雲端服務。
- **Model Registry**：集中管理模型的版本與階段狀態（如 Staging、Production），便於協作與與 CI/CD 整合。

- **[我的mlflow環境](https://github.com/yehdanny/MLflow_)**
---

### 📘 模型介紹與應用情境

#### 1. 羅吉斯回歸（Logistic Regression）

- **特點**：
  - 簡潔易解釋，適合做為 baseline。
  - 對線性關係敏感。
- **適用情境**：
  - 特徵維度較低，且可接受線性假設的資料集。
  - 需要強解釋性的商業應用，如金融風險評估。
- **缺點**：
  - 難以處理非線性或高維非結構化資料。

---

#### 2. K 最近鄰（KNN）

- **特點**：
  - 非參數模型，無需訓練即可預測。
  - 須標準化特徵距離，對離群值敏感。
- **適用情境**：
  - 小型資料集。
  - 決策邊界複雜但資料分佈稠密。
- **缺點**：
  - 計算成本高（尤其在大型資料上），難以擴展。

---

#### 3. 隨機森林（Random Forest）

- **特點**：
  - 基於多棵決策樹的集成模型，具強大擬合能力與抗雜訊能力。
  - 自動進行特徵重要性排序。
- **適用情境**：
  - 異質性高、非線性資料集。
  - 需要穩健模型的應用場景，如醫療風險預測。
- **缺點**：
  - 難以解釋每個單獨決策，模型黑盒程度較高。

---

#### 4. 深度神經網路（DNN）

- **特點**：
  - 多層感知器架構，能學習高度非線性特徵。
  - 結合 Dropout 可提升泛化能力。
- **適用情境**：
  - 大型資料集、特徵關係複雜。
  - 圖像、語音、序列等深層特徵提取需求。
- **缺點**：
  - 需較多超參數調整與訓練時間，對資料需求大。

---

#### 5. 注意力機制（Attention Mechanism）

- **特點**：
  - 適合序列輸入資料（如文本、時間序列）。
  - 具備動態聚焦特徵權重的能力。
- **適用情境**：
  - 資料存在時序性、上下文依賴性。
  - 如聊天機器人、交易行為預測。
- **缺點**：
  - 架構複雜，需更多訓練資源與資料前處理。

---

### 🧭 選模建議策略

- 初期探索：可用 Logistic Regression 作為 baseline。
- 精度優先：優先考慮 Random Forest 或深度模型。
- 解釋性要求高：採用可視化特徵權重的模型，如 RF、Logistic。
- 有時序或結構性輸入：採用 Attention 或 LSTM 變體。

---
### 🔥 模型比較 

![Accuracy_compare](./img/Accuracy_d.PNG)